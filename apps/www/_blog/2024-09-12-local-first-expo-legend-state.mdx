---
title: 'Local-first Apps with Expo and Legend-State'
description: 'Build local-first web and mobile apps with Expo, Legend-State, and Supabase.'
author: jay_meistrich,thor_schaeff
image: local-first-expo-legend_state/local-first-expo-legend_state-thumb.png
thumb: local-first-expo-legend_state/local-first-expo-legend_state-thumb.png
categories:
  - developers
tags:
  - mobile
  - local-first
date: '2024-09-12'
toc_depth: 3
---

<Admonition>

[Do you prefer audio-visual learning? Watch the video guide!]()

[Or jump straight into the code]()

</Admonition>

Legend-State is a super fast all-in-one state and sync library that lets you write less code to make faster apps. Legend-State has four primary goals:

1. As easy as possible to use.
1. The fastest React state library
1. Fine-grained reactivity for minimal renders
1. Powerful sync and persistence (now with Supabase support built in!)

And, to put the cherry on top, it works with Expo React Native out of the box! This makes it a perfect match for building local-first web and mobile apps!

## What is a Local-First Architecture?

In local-first software, "the availability of another computer should never prevent you from working" ([via Martin Kleppmann](https://www.youtube.com/watch?v=NMq0vncHJvU)). When you are offline, you can still read and write directly from/to a database on your device. You can trust the software to work offline, and you know that when you are connected to the internet, your data will be seamlessly synced and available on any of your devices running the app. When you're online, this architecture is well suited for "multiplayer" apps, as [popularized by Figma](https://www.figma.com/blog/how-figmas-multiplayer-technology-works/).

To dig deeper into what local-first is and how it works, refer to the [Expo docs](https://docs.expo.dev/guides/local-first/).

## How Legend-State makes it work

A primary goal of Legend-State is to make automatic persisting and syncing both easy and very robust, as it's meant to be used to power all storage and sync of complex apps.

Any changes made while offline are persisted between sessions to be retried whenever connected. To do this, the sync system subscribes to changes on an observable, then on change goes through a multi-step flow to ensure that changes are persisted and synced.

1. Save the pending changes to local persistence.
1. Save the changes to local persistence.
1. Save the changes to remote persistence.
1. On remote save, set any needed changes (like updatedAt) back into the observable and local persistence.
1. Clear the pending changes in local persistence.

## Setting up the Project

## Installing Dependencies

## Configuring Legend-State

## Configuring Supabase

## Realtime syncing and retrying

## Conclusion

Want to learn more about LegendState? Make sure to follow our Jay Meistrich on [Twitter](https://twitter.com/jaymeistrich)!

## More Supabase Resources

- [Flutter Tutorial: building a Flutter chat app](https://supabase.com/blog/flutter-tutorial-building-a-chat-app)
- [Generate Flame template using Very Good CLI](https://verygood.ventures/blog/generate-a-game-with-our-new-template)
- [Supabase Flutter SDK docs](https://supabase.com/docs/reference/dart/start)
